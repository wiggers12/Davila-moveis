<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sua Marca Aqui 游녬</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"/>
<style>
:root{
  --primary:#9d4edd;--secondary:#ffb347;--success:#2ecc71;--info:#4dabf7;--danger:#ff4d6d;
  --dark-bg:#0f0f1a;--card-bg:rgba(255,255,255,.08);
  --light:#fff;--shadow:0 8px 25px rgba(0,0,0,.4);
}
*{box-sizing:border-box;margin:0;padding:0;}
body{font-family:'Poppins',sans-serif;background:var(--dark-bg);color:var(--light);}
header{background:linear-gradient(135deg,#7b2cbf,#5a189a);color:#fff;padding:1.5rem;text-align:center;box-shadow:var(--shadow);}
nav{background:rgba(20,20,40,.8);backdrop-filter:blur(12px);display:flex;overflow-x:auto;position:sticky;top:0;z-index:100;}
nav button{flex:1;min-width:120px;border:none;background:none;padding:1rem;font-weight:600;cursor:pointer;color:#aaa;transition:.2s;}
nav button.active{color:var(--primary);text-shadow:0 0 8px var(--primary);}
section{display:none;padding:1.5rem;max-width:1200px;margin:auto;}
section.active{display:block;}
/* Produtos */
.swiper{width:100%;padding:1rem 0;}
.swiper-slide{background:var(--card-bg);border-radius:16px;box-shadow:var(--shadow);overflow:hidden;text-align:center;}
.swiper-slide img,.swiper-slide video{width:100%;height:220px;object-fit:cover;}
.product-info{padding:1rem;}
.order-button{background:linear-gradient(145deg,#9d4edd,#5a189a);color:#fff;border:none;padding:.7rem 1.2rem;border-radius:10px;cursor:pointer;font-weight:600;}
.order-button:disabled{background:#555;cursor:not-allowed;}
/* Modal */
#modal{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.7);display:none;align-items:center;justify-content:center;z-index:1500;}
#modal-content{background:#fff;color:#000;padding:1.5rem;border-radius:12px;width:90%;max-width:400px;}
.topping{margin:.3rem 0;}
/* Carrinho */
.cart-container{background:var(--card-bg);padding:1.5rem;border-radius:16px;box-shadow:var(--shadow);}
.cart-item{display:flex;justify-content:space-between;border-bottom:1px solid rgba(255,255,255,.1);padding:.5rem 0;}
.cart-total{font-weight:700;color:var(--secondary);text-align:right;margin-top:1rem;font-size:1.1rem;}
.btn-finish{background:linear-gradient(145deg,#2ecc71,#208d4e);color:#fff;border:none;padding:1rem;border-radius:10px;width:100%;margin-top:1rem;font-weight:700;cursor:pointer;}
/* Pedidos & Log칤stica */
.order-card{background:var(--card-bg);padding:1rem;margin:.8rem 0;border-radius:12px;box-shadow:var(--shadow);}
.status{padding:.3rem .6rem;border-radius:8px;font-size:.8rem;font-weight:600;display:inline-block;}
.status-Recebido{background:var(--info);}
.status-Prepara칞칚o{background:var(--secondary);}
.status-Saiu{background:#ffa94d;}
.status-Conclu칤do{background:var(--success);}
.status-Cancelado{background:var(--danger);}
.remove-btn{background:var(--danger);color:#fff;border:none;padding:.3rem .6rem;border-radius:6px;cursor:pointer;}
/* Financeiro */
.kpi-container{display:flex;flex-wrap:wrap;gap:1rem;margin-bottom:1.5rem;}
.kpi-card{flex:1;min-width:200px;background:var(--card-bg);padding:1rem;border-radius:12px;box-shadow:var(--shadow);text-align:center;}
.kpi-card h4{font-size:1rem;color:#ccc;}
.kpi-card p{font-size:1.4rem;font-weight:700;color:var(--primary);}
</style>
</head>
<body>

<!-- MODAL -->
<div id="modal">
  <div id="modal-content">
    <h3>Escolha complementos</h3>
    <div id="toppings"></div>
    <button onclick="confirmAdd()">Adicionar</button>
    <button onclick="closeModal()">Cancelar</button>
  </div>
</div>

<header>
  <h1>Sua Marca Aqui 游녬</h1>
  <p>Gest칚o completa: Vitrine, Estoque, Pedidos, Financeiro e Log칤stica</p>
</header>

<nav>
  <button class="active" onclick="showTab('catalogo',this)">游 Cat치logo</button>
  <button onclick="showTab('carrinho',this)">游띐 Carrinho</button>
  <button onclick="showTab('pedidos',this)">游닍 Pedidos</button>
  <button onclick="showTab('financeiro',this)">游눯 Financeiro</button>
  <button onclick="showTab('estoque',this)">游늵 Estoque</button>
  <button onclick="showTab('logistica',this)">游뚴 Log칤stica</button>
</nav>

<!-- Cat치logo -->
<section id="catalogo" class="active">
  <h2>Monte seu A칞a칤</h2>
  <div class="swiper">
    <div class="swiper-wrapper" id="products-container"></div>
  </div>
</section>

<!-- Carrinho -->
<section id="carrinho">
  <h2>游띐 Seu Pedido</h2>
  <div class="cart-container">
    <div id="cart-items"><p>Seu carrinho est치 vazio</p></div>
    <div class="cart-total">Total: <span id="cart-total-price">R$ 0,00</span></div>
    <button class="btn-finish" id="finish-order-button" disabled>Finalizar Pedido</button>
  </div>
</section>

<!-- Pedidos -->
<section id="pedidos"><h2>游닍 Pedidos</h2><div id="orders-list"></div></section>

<!-- Financeiro -->
<section id="financeiro">
  <h2>游눯 Financeiro</h2>
  <div class="kpi-container">
    <div class="kpi-card"><h4>Faturamento Total</h4><p id="kpi-revenue">R$ 0,00</p></div>
    <div class="kpi-card"><h4>Pedidos Conclu칤dos</h4><p id="kpi-orders">0</p></div>
    <div class="kpi-card"><h4>Ticket M칠dio</h4><p id="kpi-avg">R$ 0,00</p></div>
    <div class="kpi-card"><h4>Total de Frete</h4><p id="kpi-frete">R$ 0,00</p></div>
  </div>
  <canvas id="salesChart"></canvas>
</section>

<!-- Estoque -->
<section id="estoque">
  <h2>游늵 Estoque</h2>
  <div style="margin-bottom:1rem;">
    <input id="new-name" placeholder="Nome do produto">
    <input id="new-price" placeholder="Pre칞o" type="number">
    <input id="new-cost" placeholder="Custo" type="number">
    <input id="new-stock" placeholder="Estoque inicial" type="number">
    <input id="new-media" type="file" accept="image/*,video/*">
    <button onclick="addProduct()">Adicionar Produto</button>
  </div>
  <div id="stock-list"></div>
</section>

<!-- Log칤stica -->
<section id="logistica"><h2>游뚴 Log칤stica</h2><div id="logistics-list"></div></section>

<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
<script>
let cart=[],orders=JSON.parse(localStorage.getItem("acaiOrders"))||[];
let PRODUCTS=JSON.parse(localStorage.getItem("acaiProducts"))||[
  {id:1,name:"Copo 300ml",price:12,cost:6,stock:5,media:"https://images.unsplash.com/photo-1617196039897-d68e4f5a5a2c"},
  {id:2,name:"Barca de A칞a칤",price:35,cost:18,stock:3,media:"https://images.unsplash.com/photo-1598514982419-1cbcb2f3c1b9"}
];
const FRETE_FIXO=5.0;
const TOPPINGS=[{name:"Leite em p칩",price:2},{name:"Morango",price:3},{name:"Granola",price:2},{name:"Leite condensado",price:2.5}];

function showTab(id,btn){
  document.querySelectorAll("section").forEach(s=>s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
  document.querySelectorAll("nav button").forEach(b=>b.classList.remove("active"));
  if(btn) btn.classList.add("active");
  render();
}

/* Modal complementos */
let selectedProduct=null;
function openModal(id){
  selectedProduct=PRODUCTS.find(p=>p.id===id);
  document.getElementById("toppings").innerHTML=TOPPINGS.map((t,i)=>`<div class="topping"><label><input type="checkbox" value="${i}">${t.name} (+R$ ${t.price})</label></div>`).join("");
  document.getElementById("modal").style.display="flex";
}
function closeModal(){document.getElementById("modal").style.display="none";}
function confirmAdd(){
  let checkboxes=document.querySelectorAll("#toppings input:checked");
  let total=selectedProduct.price;
  let toppingsChosen=[];
  checkboxes.forEach(c=>{let t=TOPPINGS[c.value];toppingsChosen.push(t);total+=t.price;});
  cart.push({product:selectedProduct,toppings:toppingsChosen,total:total});
  selectedProduct.stock--;saveProducts();closeModal();updateCart();
}

/* Produtos */
let swiperInstance;
function renderProducts(){
  document.getElementById("products-container").innerHTML=PRODUCTS.map(p=>`
    <div class="swiper-slide">
      ${p.media.includes("video")?`<video src="${p.media}" controls></video>`:`<img src="${p.media}" alt="${p.name}">`}
      <div class="product-info">
        <h3>${p.name}</h3><p><strong>R$ ${p.price.toFixed(2)}</strong></p>
        <button class="order-button" onclick="openModal(${p.id})" ${p.stock<=0?"disabled":""}>${p.stock<=0?"Sem estoque":"Selecionar"}</button>
      </div>
    </div>`).join("");
  if(swiperInstance) swiperInstance.destroy();
  swiperInstance=new Swiper(".swiper",{slidesPerView:1,loop:true});
}

/* Carrinho */
function updateCart(){
  let c=document.getElementById("cart-items");
  if(cart.length==0){c.innerHTML="<p>Seu carrinho est치 vazio</p>";}
  else{c.innerHTML=cart.map(it=>`<div class="cart-item">${it.product.name} ${it.toppings.length?"+ "+it.toppings.map(t=>t.name).join(", "):""} <span>R$ ${it.total.toFixed(2)}</span></div>`).join("");}
  document.getElementById("cart-total-price").innerText="R$ "+cart.reduce((s,i)=>s+i.total,0).toFixed(2);
  document.getElementById("finish-order-button").disabled=cart.length==0;
}
document.getElementById("finish-order-button").addEventListener("click",finalizarPedido);

function finalizarPedido(){
  let subtotal=cart.reduce((s,i)=>s+i.total,0);
  let o={id:Date.now(),customerName:"Cliente",phone:"",deliveryType:"",address:"",notes:"",payment:"",items:cart,totalItems:subtotal,frete:0,total:subtotal,status:"Recebido",createdAt:new Date().toLocaleString()};
  orders.push(o);saveOrders();
  cart=[];updateCart();showTab('logistica',document.querySelector("nav button:last-child"));
}

/* Estoque */
function addProduct(){
 let file=document.getElementById("new-media").files[0];let reader=new FileReader();
 reader.onload=function(e){
   let p={id:Date.now(),name:document.getElementById("new-name").value,price:parseFloat(document.getElementById("new-price").value),cost:parseFloat(document.getElementById("new-cost").value),stock:parseInt(document.getElementById("new-stock").value),media:e.target.result};
   PRODUCTS.push(p);saveProducts();render();
 };
 if(file) reader.readAsDataURL(file);
}
function saveProducts(){localStorage.setItem("acaiProducts",JSON.stringify(PRODUCTS));}
function removeProduct(id){PRODUCTS=PRODUCTS.filter(p=>p.id!==id);saveProducts();render();}
function renderStock(){
 document.getElementById("stock-list").innerHTML=PRODUCTS.map(p=>`${p.name} - R$ ${p.price.toFixed(2)} - Estoque:${p.stock} <button class="remove-btn" onclick="removeProduct(${p.id})">Remover</button>`).join("<br>");
}

/* Pedidos */
function renderOrders(){
 document.getElementById("orders-list").innerHTML=orders.map(o=>`
   <div class="order-card">
     <strong>Pedido #${o.id}</strong><br>
     Itens:<ul>${o.items.map(i=>`<li>${i.product.name} ${i.toppings.length?`+ ${i.toppings.map(t=>t.name).join(", ")}`:""} - R$ ${i.total.toFixed(2)}</li>`).join("")}</ul>
     Subtotal: R$ ${o.totalItems.toFixed(2)} | Total: R$ ${o.total.toFixed(2)}<br>
     <span class="status status-${o.status}">${o.status}</span>
     <button class="remove-btn" onclick="removeOrder(${o.id})">Remover</button>
   </div>`).join("");
}
function removeOrder(id){orders=orders.filter(o=>o.id!==id);saveOrders();render();}

/* Log칤stica */
function renderLogistics(){
 let c=document.getElementById("logistics-list");
 if(orders.length===0){c.innerHTML="<p>Nenhum pedido na log칤stica.</p>";return;}
 c.innerHTML=orders.map(o=>`
   <div class="order-card">
     <strong>Pedido #${o.id}</strong><br>
     Tipo: <select onchange="setDelivery(${o.id},this.value)">
       <option ${o.deliveryType==="Retirada"?"selected":""}>Retirada</option>
       <option ${o.deliveryType==="Entrega"?"selected":""}>Entrega</option>
     </select><br>
     ${o.deliveryType==="Entrega"?`Endere칞o:<input value="${o.address}" onchange="o.address=this.value;saveOrders()">`:``}<br>
     Pagamento: <select onchange="o.payment=this.value;saveOrders()"><option>Pix</option><option>Dinheiro</option><option>Cart칚o</option></select><br>
     Subtotal: R$ ${o.totalItems.toFixed(2)} | Frete: R$ ${o.frete.toFixed(2)} | <strong>Total: R$ ${o.total.toFixed(2)}</strong><br>
     <small>Data: ${o.createdAt}</small><br>
     <select onchange="updateStatus(${o.id},this.value)">
       <option ${o.status==="Recebido"?"selected":""}>Recebido</option>
       <option ${o.status==="Prepara칞칚o"?"selected":""}>Prepara칞칚o</option>
       <option ${o.status==="Saiu"?"selected":""}>Saiu</option>
       <option ${o.status==="Conclu칤do"?"selected":""}>Conclu칤do</option>
       <option ${o.status==="Cancelado"?"selected":""}>Cancelado</option>
     </select>
   </div>`).join("");
}
function setDelivery(id,val){
 let o=orders.find(x=>x.id===id);if(!o)return;
 o.deliveryType=val;
 if(val==="Entrega"){o.frete=FRETE_FIXO;o.total=o.totalItems+o.frete;}
 else{o.frete=0;o.total=o.totalItems;}
 saveOrders();renderLogistics();
}
function updateStatus(id,newStatus){
 let o=orders.find(x=>x.id===id);
 if(o){o.status=newStatus;saveOrders();renderLogistics();renderOrders();renderFinance();}
}

/* Financeiro */
function renderFinance(){
 let concluidos=orders.filter(o=>o.status==="Conclu칤do");
 let faturamento=concluidos.reduce((s,o)=>s+o.total,0);
 let freteTotal=concluidos.reduce((s,o)=>s+o.frete,0);
 let avg=concluidos.length?f
unction renderFinance(){
 let concluidos=orders.filter(o=>o.status==="Conclu칤do");
 let faturamento=concluidos.reduce((s,o)=>s+o.total,0);
 let freteTotal=concluidos.reduce((s,o)=>s+o.frete,0);
 let avg=concluidos.length?faturamento/concluidos.length:0;

 document.getElementById("kpi-revenue").innerText="R$ "+faturamento.toFixed(2);
 document.getElementById("kpi-orders").innerText=concluidos.length;
 document.getElementById("kpi-avg").innerText="R$ "+avg.toFixed(2);
 document.getElementById("kpi-frete").innerText="R$ "+freteTotal.toFixed(2);

 let salesByDay=concluidos.reduce((acc,o)=>{
   let d=new Date(o.createdAt).toLocaleDateString();
   acc[d]=(acc[d]||0)+o.total;
   return acc;
 },{});

 let ctx=document.getElementById("salesChart").getContext("2d");
 if(window.salesChart)window.salesChart.destroy();
 window.salesChart=new Chart(ctx,{
   type:"bar",
   data:{
     labels:Object.keys(salesByDay),
     datasets:[{
       label:"Faturamento di치rio",
       data:Object.values(salesByDay),
       backgroundColor:"rgba(157,77,237,0.7)"
     }]
   },
   options:{scales:{y:{beginAtZero:true}}}
 });
}

/* Helpers */
function saveOrders(){localStorage.setItem("acaiOrders",JSON.stringify(orders));}

/* Render inicial */
function render(){
  renderProducts();
  renderStock();
  renderOrders();
  renderLogistics();
  renderFinance();
}
render();
</script>
</body>
</html>